/***************************************************************************//**
  @file     App.c
  @brief    TP2: Comunicacion Serie
  @author   Grupo 5
 ******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include <stdio.h>
#include "uart2char/uart2char.h"
#include "fsk2uart/fsk2uart.h"
/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/


void App_Init (void)
{

}

void App_Run (void)
{
	double DATA1S0S [580] = {0,0.78161,0.97509,0.43485,-0.43259,-0.97453,-0.78317,-0.0025133,0.68271,0.99697,0.56104,-0.29704,-0.93162,-0.86519,-0.14774,0.68087,0.9977,0.67533,-0.15519,-0.86894,-0.92885,-0.28983,0.56727,0.99752,0.7753,-0.68729,-0.67348,0.78706,0.55688,-0.86956,-0.42805,0.93298,0.52838,-0.88582,-0.39715,0.94465,0.2572,-0.98276,-0.11161,0.99929,0.22427,-0.6218,-1,-0.62573,0.21937,0.89941,0.90268,0.22672,-0.50145,-0.82567,0.62377,0.73326,-0.7324,-0.62475,0.82496,0.50254,-0.75508,-0.5979,0.84365,0.47292,-0.91372,-0.33756,0.96372,0.19478,-0.92697,-0.30543,0.97222,0.1614,-0.99613,-0.013823,0.99818,-0.13406,-0.99854,0.020105,0.99556,-0.16759,-0.97073,0.31141,0.9246,-0.44838,-0.96203,0.34346,0.91114,-0.47845,-0.84026,0.60293,0.75094,-0.71418,-0.82139,-0.066553,0.73836,0.98769,0.49382,-0.37163,-0.95744,-0.82282,-0.21078,0.99046,0.064045,-0.99995,0.084095,0.98749,-0.23039,-0.95336,0.11785,0.84967,0.94215,0.3257,-0.53583,-0.99417,-0.70444,0.11535,0.76407,0.58677,-0.85099,-0.4607,0.91925,0.32451,-0.96732,-0.18121,0.93207,0.29224,-0.97537,-0.14774,0.99725,2.9379e-15,-0.99725,0.14774,0.99919,0.65469,-0.18244,-0.88229,-0.91825,-0.26327,0.58982,0.99909,0.75754,-0.70711,-0.65279,0.80382,0.5337,-0.88288,-0.40291,0.94257,0.50471,-0.8983,-0.37163,0.95336,0.23039,-0.98749,-0.084095,0.99995,0.19725,-0.99227,-0.050244,0.99971,-0.097861,-0.98522,0.24382,0.9491,-0.13156,-0.85688,-0.93743,-0.3126,0.54745,0.99556,0.69456,-0.12907,-0.77291,-0.57552,0.85817,0.44838,-0.9246,-0.31141,0.97073,0.16759,-0.93699,-0.27899,0.97832,0.13406,-0.99818,0.013823,0.99613,-0.1614,-0.99965,0.047734,0.99258,-0.19478,-0.96372,0.33756,0.91372,-0.47292,-0.95411,-0.3611,0.50362,0.98939,0.73069,-0.077833,-0.82779,-0.95486,-0.49273,0.90429,0.35876,-0.95744,-0.21692,0.98958,0.070314,-0.99999,-0.18368,0.99389,0.036434,-0.99929,0.11161,0.98276,-0.2572,-0.94465,0.14525,0.86392,0.93253,0.29944,-0.55896,-0.99677,-0.68455,0.14277,0.78161,0.56416,-0.86519,-0.43599,0.92978,0.29824,-0.97396,-0.15395,0.94173,0.85033,0.1191,-0.70176,-0.99457,-0.53901,0.32213,0.94088,0.91775,-0.46404,-0.84901,0.58982,0.76163,-0.70265,-0.65753,0.80006,0.73921,-0.065299,-0.82067,-0.95852,-0.37512,0.49054,0.98709,0.7409,0.080338,-0.72897,-0.98976,-0.50579,0.35876,0.95336,0.8306,0.082843,-0.6218,-1,-0.62573,0.21937,0.89941,0.90268,0.22672,-0.61983,-0.98903,-0.074074,1,-0.074074,-0.98903,0.2206,0.95635,-0.36228,-0.98345,-0.47181,0.39484,0.96439,0.80828,0.043968,-0.75343,-0.9839,-0.59488,0.84567,0.46959,-0.91524,-0.334,0.96472,0.19108,-0.99303,-0.30184,0.9731,0.15768,-0.99646,-0.010053,0.99795,-0.13779,-0.97753,0.023874,0.79628,0.96951,0.41323,-0.45399,-0.9796,-0.7681,0.021361,0.69996,0.66037,-0.79779,-0.54218,0.87812,0.41209,-0.93917,-0.27295,0.89384,0.38094,-0.95028,-0.24016,0.98586,0.094108,-0.9998,0.054009,0.99097,0.060282,-0.9999,0.087851,0.98689,-0.23406,-0.95221,0.37512,0.98085,-0.2669,-0.94131,0.40635,0.88111,-0.53689,-0.80157,0.65564,0.86456,-0.5652,-0.78082,0.68087,0.67995,-0.78161,-0.56416,0.86519,0.65469,-0.18244,-0.88229,-0.91825,-0.26327,0.58982,0.99909,0.65659,-0.03769,-0.99375,0.18491,0.96636,-0.32808,-0.91775,0.46404,0.84901,-0.35993,-0.95374,-0.8299,-0.081591,0.72811,0.98993,0.50688,-0.35759,-0.89995,-0.36812,0.95449,0.22672,-0.98808,-0.080338,0.99998,-0.067806,-0.99273,-0.046479,0.99962,-0.10161,-0.98456,0.24747,0.9479,-0.3879,-0.97806,-0.44726,0.42009,0.97133,0.79169,0.016336,-0.77131,-0.97858,-0.57243,0.8601,0.44501,-0.92603,-0.30782,0.97163,0.16388,-0.99591,-0.27537,0.9791,0.13032,-0.9984,0.017592,0.9958,-0.16512,-0.97133,0.051499,0.99211,-0.19848,-0.96271,0.3411,0.91218,-0.47624,-0.84162,0.37279,0.89775,-0.50579,-0.82282,0.62769,0.72983,-0.73581,-0.62082,0.65374,0.70622,-0.75836,-0.59387,0.84634,0.46849,-0.91575,-0.33282,0.86392,0.93253,0.29944,-0.55896,-0.99677,-0.68455,0.14277,0.86265,0.97509,-0.29344,-0.93162,0.43146,0.8677,-0.56,-0.78473,0.67626,0.85033,0.1191,-0.70176,-0.99457,-0.53901,0.32213,0.94088,0.85165,0.26205,-0.98181,-0.1166,0.99909,-0.031411,-0.99443,0.17873,0.96796,-0.065299,-0.99029,0.21201,0.95888,-0.35406,-0.90643,0.48835,0.83408,-0.38558,-0.96168,-0.81416,-0.054009,0.74678,0.98564,0.48285,-0.38326,-0.91166,-0.34228,0.96237,0.19971,-0.99196,-0.052754,0.99977,-0.095359,-0.99568,-0.018848,0.99847,-0.12907,-0.97935,0.27416,0.93873,-0.41323,-0.97193,0.30663,0.9265,-0.44388,-0.86074,0.5714,0.77609,-0.68638,-0.84298,-0.10536,0.71154,0.99303,0.52731,-0.33519,-0.94547,-0.84433,-0.24869,0.98434,0.10286,-0.99958,0.045224,0.99288,-0.19232,-0.96439,0.079085,0.98827,-0.2255,-0.95486,0.36696,0.9005,-0.50036,-0.82637,0.3983,0.88523,-0.52945,-0.8068,0.64897,0.71065,-0.75425,-0.59891,0.67441,0.99778,0.57037,-0.28622,-0.92745,-0.8708,-0.15892,0.67255,0.99687,0.0050265,-0.99761,0.14277,0.97646,-0.28743,-0.93388,0.42578,0.96858,-0.31975,-0.92121,0.45623,0.85362,-0.58269,-0.7673,0.69636,0.83546,0.091606,-0.72118,-0.99131,-0.51552,0.34818,0.94988,0.83684,0,0,0,0};

	// DATA1S0S contiene la palabra ADWAAD

	initDSP_FSK_2_UART();
	uart2charParser parser;
	initUart2charParser(&parser);

	while(1){
		for(uint16_t i = 0; i < 580; i++){
			BitStruct bs = pushSample(DATA1S0S[i]);
			if(bs.newBit == true){
				pushBit(&parser, bs.bit);
			}
		}
		while(isNewByte(&parser)){
			ByteStruct By = getByte(&parser);
			printf("%c ", By.byte);
		}
		while(1);
	}

	/*
	uart2charParser MyParser;
	initUart2charParser(&MyParser);
	uint8_t chain [] = {1, 1, 1, 1, 1, 0, 1, 0, 0};
	for(uint8_t i = 0; i < 9; i++){
		pushBit(&MyParser, chain[i]);
	}
	ByteStruct myByte = getByte(&MyParser);
	printf("%X \n", myByte.byte);
	while(1);*/
}







